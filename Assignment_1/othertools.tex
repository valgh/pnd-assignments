\section{Additional measures}
Configuring \textbf{Arpwatch} as described in the previous section is obviously not enough to guarantee a certain level of security in the target network, so we decided to take some extra measures that were not required by the assignment.\\
As a best practice, we chose to change the default passwords of every account in the machines of the network - except the internal router. Strong, secure passwords on the \textbf{arpwatch machine} are a must-have in order for the monitoring system to actually be effective.\\
Apart from best practices, we needed to take into account possible threats such as \textbf{escalation of privilege} and \textbf{tampering} with the scripts' input in the \textbf{arpwatch machine}, so to make it difficult for an adversary to disrupt the monitoring system.

\subsection{Escalation of privilege on the Arpwatch machine}
This issue is pretty self-explanatory: in order for the script to be running, \textbf{root} has to be logged-in in the machine, meaning that an adversary could simply access it knowing its location (i.e., its IP address) and, being already logged-in as \textbf{root}, simply terminate the execution of the monitoring scripts, e.g. just by logging out of the account. Notice that this scenario could lead to even worse results for our system, such as the adversary being able to do basically everything he wants from the \textbf{arpwatch machine}. First measure we took was to actually launch the script at login such as, even when \textbf{root} or any other user logs out from bash, the monitoring script keeps running: this result was obtained through the \textbf{nohup} command being concatenated to the script when it is launched. This way, even if the user who executed the script logs out, it keeps running.\\
We do not need the \textbf{root} account to be logged in now to keep watching for possible spoofing attacks, but it is in general a best practice to execute scripts with the least possible privilege, so monitoring through \textbf{root} still seems a pretty bad idea. Indeed, if an adversary is granted access as \textbf{root}, he can still terminate the execution of the script, reboot or shut down the system. As a further security measure, a new account was created on the machine - \textbf{watchdog} - with no directory assigned and no privileges granted, so that it cannot create new files, edit old ones or execute files he does not own. This user basically doesn't own any file, but is given some specific permissions in order to perform the monitoring activity: first, he is able to \textit{only read} the arpwatch logs under \textit{/var/log/arpwatch.log}. Thanks to the \textbf{sudo} tool, \textbf{watchdog} is able to launch from login the monitoring scripts - so that he can read and execute them, but not modify or delete them - and the \textbf{Python script} has been granted the privilege to actually create sockets and send packets through the \textbf{setcap} tool.\\
Also, the file \textbf{arp.dat} where the tool stores the arp entries is usually located at \textit{/var/lib/arpwatch}, but when run from \textbf{watchdog} arpwatch actually runs from directory \textbf{/}, so a new file \textbf{arp.dat} was created and owned by \textbf{root} in this directory. We tested and found out that \textbf{arpwatch}, when run by \textbf{watchdog}, uses this file and reads from it: this approach should be more secure since \textbf{watchdog} user cannot write to this second \textbf{arp.dat}, but \textbf{arpwatch} can still edit it while running without saving it, so it is able to store all the arp entries it needs there. When the script is eventually terminated by performing a rebot or a shut down from \textbf{root}, the file isn't saved, meaning the arp entries are lost and new stations will have to be re-discovered at new script startup, but this doesn't seem to affect badly the live detection, supposing a reboot of the machine will not occur frequently.\\
Notice that every other action in the machine requires \textbf{watchdog} to input the \textbf{root} password, which was changed, and he cannot create new files since he does not even own a directory - so, even if files executed in \textbf{Python} environment are actually able to send packets over the network, \textbf{watchdog} cannot create nor execute them: if he wants to, he needs to input \textbf{root} password to be granted superuser privileges.\\
Furthermore, commands such as \textbf{reboot} and \textbf{shutdown} are disabled by default for \textbf{watchdog}, and even if the adversary logs out from this account, the monitoring script will keep running as previously mentioned.\\
At this point, the adversary cannot pose a threat to the machine that is worse than just killing the process related tot he monitoring script, which at least can be prevented by logging in as \textbf{watchdog}, let the machine run the script and then log out - if passwords of the two accounts are not known to the adversary, the script's execution cannot be terminated.\\
Since the adversary is able to execute the monitoring scripts, he could provide \textbf{scapySendPacket.py} a bad input and exploit it to send packets over the network, which is an issue we deal with in the next subsection.\\

\subsection{Input validation in scapySendPacket.py}
